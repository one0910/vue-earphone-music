import{P as C,m as h,u as g,L as p,b as f,c as S,Q as b,R as x,_ as v,F as y,o as m,d as c,G as I,e as t,t as l,w as d,I as w,S as D,B as L,C as F,T as k,U as N,D as P,E as A,V as R,W as T,s as M,h as V,A as B,n as z,J as E}from"./index-D77V6bSs.js";import{u as $}from"./albumInfo-BC6tUbv6.js";import{m as j}from"./logo-822ZX3bq.js";const U={data(){return{isCurrentPlaying:!1,toggle:!1,message:"",isFavSong:!1,success:!1}},components:{toastMessage:C},props:{songData:{type:Object,required:!0},index:{type:Number,required:!0}},computed:{...h(g,["playing","current_song","pauseCurrentSong"]),...h(p,["userLoggedIn","uid"]),...f(g,["playingIndex"]),...f(p,["favSongList"])},methods:{...S(g,["newSong"]),playSong(e){this.newSong(e),this.isCurrentPlaying=!0},addToFav(e){this.userLoggedIn?(this.setFavSongToDatabase(e.docID),this.toggle=!this.toggle,this.success=!0,this.message=this.$t("alertMsg.add_song_to_list",{favsongName:e.modified_name})):(this.toggle=!this.toggle,this.message="該功能需登入才可使用，可免費註冊使用")},async delFormFav(e){try{await b.doc(this.uid).update({favSongLists:x.firestore.FieldValue.arrayRemove(e.docID)}),this.favSongList=this.favSongList.filter(n=>e.docID!==n),this.isFavSong=!1,this.toggle=!this.toggle,this.success=!0,this.message=this.$t("alertMsg.delete_song_form_play_list",{favsongName:e.modified_name})}catch(s){console.log("error => ",s)}},async setFavSongToDatabase(e){try{await b.doc(this.uid).update({favSongLists:x.firestore.FieldValue.arrayUnion(e)}),this.favSongList.push(e),this.isFavSong=!0}catch(s){console.log("error => ",s)}}},mounted(){this.favSongList.length!==0&&(this.isFavSong=this.favSongList.includes(this.songData.docID))},watch:{playing(){this.current_song&&(this.current_song.modified_name==this.songData.modified_name?(this.isCurrentPlaying=!0,this.playingIndex=this.index):this.isCurrentPlaying=!1)},pauseCurrentSong(){this.pauseCurrentSong&&this.pauseCurrentSong.pause&&(this.current_song.modified_name==this.pauseCurrentSong.currentSong?this.isCurrentPlaying=!1:this.isCurrentPlaying=!0)}}},q=t("p",{class:"flex-initial md:w-20 w-10"},"03:57",-1),J={class:"flex-initial md:w-12 w-10 md:text-center text-end"},W={key:0,class:"far fa-play-circle text-2xl text-rose-500/80"},G={key:1,class:"far fa-pause-circle text-2xl text-rose-500/80"},O=t("i",{class:"far fa-heart text-2xl text-rose-500/80"},null,-1),Q=[O],Y=t("i",{class:"fas fa-heart text-2xl text-rose-500/80"},null,-1),H=[Y];function K(e,s,n,i,o,a){const u=y("toastMessage");return m(),c(w,null,[I(u,{toggle:o.toggle,message:o.message,success:o.success},null,8,["toggle","message","success"]),t("p",{class:"flex-1 truncate pr-3 cursor-pointer",onClick:s[0]||(s[0]=d(r=>a.playSong(n.songData),["prevent"]))},l(n.songData.modified_name),1),t("div",{class:"flex cursor-pointer justify-center items-center",onClick:s[1]||(s[1]=d(r=>a.playSong(n.songData),["prevent"]))},[q,t("div",J,[o.isCurrentPlaying?(m(),c("i",G)):(m(),c("i",W))])]),o.isFavSong?(m(),c("div",{key:1,class:"w-10 text-end cursor-pointer",onClick:s[3]||(s[3]=d(r=>a.delFormFav(n.songData),["prevent"]))},H)):(m(),c("div",{key:0,class:"w-10 text-end cursor-pointer",onClick:s[2]||(s[2]=d(r=>a.addToFav(n.songData),["prevent"]))},Q))],64)}const X=v(U,[["render",K]]),Z={data(){return{isPlaying:!1,songs:[],memberImage:j}},components:{SongItem:X},computed:{...h(g,["albumPageImgClass"]),...f($,["albumInfo"]),...f(g,["songList"]),...f(D,["toastCount"]),albumSingerImg(){return this.albumInfo.albumSingerImg?this.albumInfo.albumSingerImg:"https://i.imgur.com/arYdJI6.png"},signerName(){const{albumSinger:e,type:s,temp:n}=this.albumInfo;return s==="member_fundraising"?L(e,s,n):F(e)},signerDescription(){const{albumSinger:e,albumSingerDesc:s,type:n,temp:i}=this.albumInfo;return n==="member_fundraising"?k(e,s,n,i):N(e,s)},albumName(){const{albumName:e,type:s,temp:n}=this.albumInfo;return s==="member_fundraising"?P(e,s,n):A(e)},albumDescription(){const{albumName:e,albumDesc:s,type:n,temp:i}=this.albumInfo;return n==="member_fundraising"?R(e,s,n,i):T(e,s)}},methods:{...S(g,["newSong"]),async getAlbumSongs(){try{(await M.where("display_name","==",this.$route.params.albumSinger).get()).forEach((s,n)=>{this.songs.push({...s.data(),docID:s.id})})}catch(e){console.log("getAlbumSongs error => ",e)}},palySong(){this.newSong(this.songList[0]),this.isPlaying=!0},formatIndex:V.formatIndex},async mounted(){await this.getAlbumSongs(),this.songList=this.songs,window.scrollTo({top:0,left:0,behavior:"auto"}),this.toastCount=0},async beforeRouteEnter(e,s,n){try{const i=await B.doc(e.params.gener).get();n(o=>{const a=i.data().items.filter(u=>u.albumSinger===o.$route.params.albumSinger);o.albumInfo={...a[0]}})}catch{}}},ee={class:"text-zinc-200 bg-zinc-900 pb-8 mt-[63px] mb-[90px]",id:"albumPage"},se={class:"max-w-[1200px] mx-auto pt-10"},te={class:"flex md:flex-row flex-col"},ne={class:"md:order-1 order-last w-[25%] hidden md:block sidebarBackgound"},ae={class:"max-w-[160px] mx-auto"},oe=["src"],ie={class:"text-center mt-6 px-5"},re={class:"text-lg"},le={class:"text-2xl pb-3"},me={class:"text-zinc-400 text-left"},ce={class:"md:order-2 flex-1 px-3 md:px-14"},ge={class:"md:flex items-center border-b-2 border-[#e6dbdb21] pb-4"},ue={class:"flex md:flex-row flex-col justify-center"},de=["src"],fe={class:"md:ml-10 md:mt-5 text-center md:text-left"},he={class:"text-[25px] tracking-widest leading-loose text-white"},_e={class:"md:pb-5"},pe={class:"md:block hidden max-w-80"},be={class:"mt-6"},xe={class:"px-2 md:px-0"},Se={class:"flex-none w-7 md:w-24 text-[12px] md:text-base md:leading-normal leading-6"};function ve(e,s,n,i,o,a){const u=y("SongItem");return m(),c("main",ee,[t("div",se,[t("div",te,[t("div",ne,[t("div",ae,[t("img",{class:"rounded-full",src:a.albumSingerImg,alt:""},null,8,oe)]),t("div",ie,[t("p",re,l(e.$t("singer")),1),t("p",le,l(a.signerName),1),t("p",me,l(a.signerDescription),1)])]),t("div",ce,[t("div",ge,[t("div",ue,[t("div",{class:z(["mx-auto",e.albumPageImgClass]),onClick:s[0]||(s[0]=d((...r)=>a.palySong&&a.palySong(...r),["prevent"]))},[t("img",{src:e.albumInfo.albumImg,alt:""},null,8,de)],2),t("div",fe,[t("p",he,l(a.albumName),1),t("p",_e,l(a.signerName),1),t("p",pe,l(a.albumDescription),1)])])]),t("div",be,[t("ul",xe,[(m(!0),c(w,null,E(o.songs,(r,_)=>(m(),c("li",{class:"flex py-3 items-center",key:r.coverImg},[t("p",Se,l(a.formatIndex(_))+". ",1),I(u,{songData:r,index:_},null,8,["songData","index"])]))),128))])])])])])])}const Ce=v(Z,[["render",ve]]);export{Ce as default};
